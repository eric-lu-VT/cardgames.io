<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Liar's Poker - netcardgames.org</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/fontawesome.css">
    <link rel="stylesheet" href="../../assets/vendors/css/glightbox.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
      .rounded-pill {
        width: 25%;
        left: 37.5%;
        padding: 2px;
        margin-bottom: 16px
      }
      .form-control {
        position: absolute;
        width: 25%;
        left: 37.5%;
        align-self: center;
      }
      ol {
        padding-left: 0;
        list-style-position: inside;
      }
      #gameMenu {
        position: absolute;
        top: 56px;
        right: 0;
        z-index: 2;
        min-width: 41%;
      }
      #menuEnterNickname {
        display: none;
      }
      #gameSettingsScreen {
        display: none;
      }
      #initErrorMsg {
        display: none;
      }
      #gameScreen {
        display: none;
      }

      #takeTurnScreen {
        display: none;
      }
      #resultScreen {
        display: none;
      }
      #cannotJoinScreen {
        display: none;
      }
      #cannotJoinScreen2 {
        display: none;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark menu shadow fixed-top">
      <div class="container">
        <a class="navbar-brand" href="/">netcardgames.org</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item"><a class="nav-link" href="/liars-poker">Liar's Poker</a></li>
            <li class="nav-item"><a class="nav-link" href=""></a></a></li>
            <li class="nav-item"><a class="nav-link" href="https://eric-lu.com/about">FAQ</a></li>
            <li class="nav-item"><a class="nav-link" href="https://eric-lu.com/contact">Contact</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div id="gameMenu">
      <div class="accordion-item shadow mb-3 fw-light">
        <h2 class="accordion-header" id="headingZero">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseZero" aria-expanded="false" aria-controls="collapseZero">
            <strong>Game Menu</strong>
          </button>
        </h2>
        <div id="collapseZero" class="accordion-collapse collapse show" aria-labelledby="headingZero" data-bs-parent="#accordionExample">
          <div class="accordion-body fw-light text-center">
            <h1 class="display-3 fw-bold text-uppercase gameId"></h1>
            <div class="heading-line"></div>
            <p class="playerNames lead"></p>
            
            <div id = "menuEnterNickname" class="form-group" style="margin-bottom: 60px">
              <input type="text" placeholder="Enter New Nickname" id="txtName" class="form-control form-control-md" style="text-align: center; min-width: 50%; left: 25%"/>
            </div>
            <div>
              <button type="button" class="rounded-pill btn-rounded border-primary" id="btnChangeName" style="min-width: 50%; left: 25%">
                <a class="nav-link" id="btnChangeNameTxt">
                  Change Nickname
                </a>
              </button>
            </div>
            <div class="heading-line"></div>

            <p class="gameMode lead"><strong>Game mode: </strong>NORMAL</p>
            <p class="startNumCards lead"></p>
            <p class="maxNumCards lead"></p>
          </div>
        </div>
      </div>
      
    </div>

    <section id="initialScreen" class="faq">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row mt-5 mb-4 g-3 text-center">
          <h1 class="display-3 fw-bold text-uppercase gameId"></h1>
          <div class="heading-line"></div>
        </div>
        <!-- ACCORDION CONTENT  -->
        <div class="row mt-5">
          <div class="col-md-12">
            <div class="accordion" id="accordionExample">
              <!-- ACCORDION ITEM 1 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingOne">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                    <strong>Current Game Settings</strong>
                  </button>
                </h2>
                <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center">
                    
                    <p class="gameMode lead"><strong>Game mode: </strong>NORMAL</p>
                    <p class="startNumCards lead"></p>
                    <p class="maxNumCards lead"></p>

                  </div>
                </div>
              </div>
              <!-- ACCORDION ITEM 2 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingTwo">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                    <strong>Players</strong>
                  </button>
                </h2>
                <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center">
                    
                    <p class="playerNames lead"></p>

                  </div>
                </div>
              </div>  
              
              <section id="gameSettingsScreen">
                <!-- ACCORDION ITEM 3 -->
                <div class="accordion-item shadow mb-3 fw-light">
                  <h2 class="accordion-header" id="headingThree">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                      <strong>Manage Game</strong>
                    </button>
                  </h2>
                  <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
                    <div class="accordion-body fw-light">
                      <div>
                        <button type="button" class="rounded-pill btn-rounded border-primary" style="margin-bottom: 0px" id="btnGameMode">
                          <a class="nav-link" id=btnGameModeTxt>
                            Game Mode: NORMAL
                          </a>
                        </button>
                      </div>
                      <div class="row text-center mt-4"></div>
                      <div>
                        <button type="button" class="rounded-pill btn-rounded border-primary" style="margin-bottom: 0px" id="btnInit">
                          <a class="nav-link">
                            Start Game
                          </a>
                        </button>
                      </div>
                      <div class="row text-center mt-4" id = "initErrorMsg">
                        <h4 class="fw-bold lead mb-3">Cannot start game: need at least two players</h4>
                      </div>
                    </div>
                  </div>
                </div>
              </section>

            </div>
          </div>
        </div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
      </div>
    </section>

    <section id="gameScreen">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <!-- ACCORDION CONTENT  -->
        <div class="row mt-5">
          <div class="col-md-12">
            <div class="accordion" id="accordionExample">
              
              <section id="gameScreenAlivePlayers">
                <section id="gamePlayScreen">
                  <div class="container">
                    <div class="row mt-5 mb-4 g-3 text-center">
                      <p class="lead" id="txtYourTurn"></p>
                      <p class="lead">You may either propose a better hand, or challenge the previous player.</p>
                      <p class="lead">(An example of a valid hand request is: "Kd 5s Tc Ah Qc".)</p>

                      <div class="heading-line"></div>
                      
                      <div style="position: relative; margin-bottom: 0px">
                        <input type="text" placeholder="Propose New Hand" id="txtNextHand" class="form-control form-control-md" style="text-align: center">
                        <button type="button" class="rounded-pill btn-rounded border-primary" style="margin-top: 42px" id="btnTakeTurn">
                          <a class="nav-link">
                            Take Turn
                          </a>
                        </button>
                        <h4 class="fw-bold lead" style="margin-bottom: 0px">OR</h4>
                      </div>
                      <div>
                        <button type="button" class="rounded-pill btn-rounded border-primary" style="margin-bottom: 0px" id="btnChallenge">
                          <a class="nav-link">
                            Challenge
                          </a>
                        </button>
                      </div>

                      <div>
                        <h4 class="fw-bold lead mb-3" id ="txtTakeTurnMsg"></h4>
                      </div>
                    </div>
                  </div>
                </section>

                <section id = "gameWaitScreen">
                  <div class="container">
                    <div class="row mt-5 mb-4 g-3 text-center">
                      <p class="lead" id="txtNotYourTurn"></p>
                    </div>
                  </div>
                </section>
                
                <!-- ACCORDION ITEM 7 -->
                <div class="accordion-item shadow mb-3 fw-light">
                  <h2 class="accordion-header" id="headingSeven">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                      <strong>Your Cards</strong>
                    </button>
                  </h2>
                  <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" data-bs-parent="#accordionExample">
                    <div class="accordion-body fw-light" style="text-align: center" id = "imgCurrentUserCards"></div>
                  </div>
                </div> 
              </section>
              
              <!-- ACCORDION ITEM 4 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingFour">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                    <strong>Player Statuses</strong>
                  </button>
                </h2>
                <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center">
                    
                    <p class="lead" id="playersNumCards"></p>

                  </div>
                </div>
              </div>
              <!-- ACCORDION ITEM 5 -->
              <div class="accordion-item shadow mb-3 fw-light" id="middleCards">
                <h2 class="accordion-header" id="headingFive">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                    <strong>Community Cards</strong>
                  </button>
                </h2>
                <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgSharedCards"></div>
                </div>
              </div>  

              <!-- ACCORDION ITEM 6 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingSix">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                    <strong>Current Hand To Beat</strong>
                  </button>
                </h2>
                <div id="collapseSix" class="accordion-collapse collapse" aria-labelledby="headingSix" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgCurrentHand"></div>
                </div>
              </div> 

            </div>
          </div>
        </div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
      </div>
    </section>

    <section id="takeTurnScreen">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <!-- ACCORDION CONTENT  -->
        <div class="row mt-5">
          <div class="col-md-12">
            <div class="accordion" id="accordionExample">
              <!-- ACCORDION ITEM 7 -->
              <div class="accordion-item shadow mb-3 fw-light" id="txtCdRmv">
                <h2 class="accordion-header" id="headingSeven">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                    <strong>Cards removed from the current hand:</strong>
                  </button>
                </h2>
                <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgRemovedCards"></div>
                </div>
              </div>
              <!-- ACCORDION ITEM 8 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingEleven">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
                    <strong>Cards added to the current hand:</strong>
                  </button>
                </h2>
                <div id="collapseEight" class="accordion-collapse collapse" aria-labelledby="headingEight" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgAddedCards">
                  </div>
                </div>
              </div>
              <!-- ACCORDION ITEM 9 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingNine">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
                    <strong>Current hand to beat:</strong>
                  </button>
                </h2>
                <div id="collapseNine" class="accordion-collapse collapse" aria-labelledby="headingNine" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgCurrentHand2">
                  </div>
                </div>
              </div>
              <div id="showBtnOk2">
                <button type="button" class="rounded-pill btn-rounded border-primary" id="btnOk2">
                  <a class="nav-link">
                    OK
                  </a>
                </button>
              </div>   
            </div>
          </div>
        </div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
      </div>
    </section>

    <section id="resultScreen">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <!-- ACCORDION CONTENT  -->
        <div class="row mt-5">
          <div class="col-md-12">
            <div class="accordion" id="accordionExample">
              <!-- ACCORDION ITEM 10 -->
              <div class="accordion-item shadow mb-3 fw-light" id="txtCdRmv">
                <h2 class="accordion-header" id="headingTen">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
                    <strong>The cards in play:</strong>
                  </button>
                </h2>
                <div id="collapseTen" class="accordion-collapse collapse" aria-labelledby="headingTen" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgCardsInPlay"></div>
                </div>
              </div>
              <!-- ACCORDION ITEM 11 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingEleven">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEleven" aria-expanded="false" aria-controls="collapseEleven">
                    <strong>Current hand status:</strong>
                  </button>
                </h2>
                <div id="collapseEleven" class="accordion-collapse collapse" aria-labelledby="headingEleven" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center" id="imgCurrentHand3"></div>
                  <div class="accordion-body fw-light" style="text-align: center">
                    <p class="lead" id="txtTurnResult"></p>
                  </div>
                </div>
              </div>
              <!-- ACCORDION ITEM 12 -->
              <div class="accordion-item shadow mb-3 fw-light">
                <h2 class="accordion-header" id="headingTwelve">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwelve" aria-expanded="false" aria-controls="collapseTwelve">
                    <strong>Round results:</strong>
                  </button>
                </h2>
                <div id="collapseTwelve" class="accordion-collapse collapse" aria-labelledby="headingTwelve" data-bs-parent="#accordionExample">
                  <div class="accordion-body fw-light" style="text-align: center">
                    <p class="lead" id="txtTurnResult2"></p>
                    <p class="lead" id="txtTurnResult3"></p>
                    <p class="lead" id="txtTurnResult4"></p>
                  </div>
                </div>
              </div>
              <div id="showBtnOk">
                <button type="button" class="rounded-pill btn-rounded border-primary" id="btnOk">
                  <a class="nav-link">
                    OK
                  </a>
                </button>
              </div>   
            </div>
          </div>
        </div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
        <div class="row text-center mt-5"></div>
      </div>
    </section>

    <section id="cannotJoinScreen">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row mt-5 mb-4 g-3 text-center">
          <p class="lead">This game has already started. You cannot join.</p>
          <button type="button" class="rounded-pill btn-rounded border-primary btnGoBack">
            <a class="nav-link">
              OK
            </a>
          </button>
        </div>
      </div>
    </section>

    <section id="cannotJoinScreen2">
      <div class="container">
        <div class="row text-center mt-5"></div>
        <div class="row mt-5 mb-4 g-3 text-center">
          <p class="lead">This game is full (8 players max). You cannot join.</p>
          <button type="button" class="rounded-pill btn-rounded border-primary btnGoBack">
            <a class="nav-link">
              OK
            </a>
          </button>
        </div>
      </div>
    </section>
      
    <footer class="footer fixed-bottom">
      <!-- START THE SOCIAL MEDIA CONTENT  -->
      <div class="footer-sm" >
        <div class="container">
          <div class="row py-2 text-center text-white">
            <div class="col-12">
              <div class="footer-bottom__copyright">
                <a href="https://github.com/eric-lu-VT/netcardgames.org"><i class="fab fa-github" style="font-size: 16px"></i></a>
                | Created by <a href="https://eric-lu.com/" target="_blank">Eric Lu</a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
    </footer>
     
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" 
    integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" 
    crossorigin="anonymous"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      var collapseElementList = [].slice.call(document.querySelectorAll('.collapse'));
      var collapseList = collapseElementList.map(function (collapseEl) {
        return new bootstrap.Collapse(collapseEl)
      });
      
      let client = null;
      let clientId = null;
      let clientName = localStorage.getItem("clientName"); 
      let gameId = null;

      const gameMenu = document.getElementById("gameMenu");
      const initialScreen = document.getElementById("initialScreen");
      const gameScreen = document.getElementById("gameScreen");
      const gameScreenAlivePlayers = document.getElementById("gameScreenAlivePlayers");
      const gamePlayScreen = document.getElementById("gamePlayScreen");
      const gameWaitScreen = document.getElementById("gameWaitScreen");
      const takeTurnScreen = document.getElementById("takeTurnScreen");
      const resultScreen = document.getElementById("resultScreen");
      const cannotJoinScreen = document.getElementById("cannotJoinScreen");
      const cannotJoinScreen2 = document.getElementById("cannotJoinScreen2");

      const btnGameMode = document.getElementById("btnGameMode");
      const btnInit = document.getElementById("btnInit");
      const btnChangeName = document.getElementById("btnChangeName");
      const btnTakeTurn = document.getElementById("btnTakeTurn");
      const btnChallenge = document.getElementById("btnChallenge");
      const btnOk = document.getElementById("btnOk");
      const btnOk2 = document.getElementById("btnOk2");
      const btnGoBack = document.querySelectorAll(".btnGoBack");

      var socket = io("/liars-poker");

      socket.on('connect', () => {
        clientId = socket.id;
        if(clientName === null) {
          clientName = clientId;
        }
        gameId = window.location.pathname.substring(19);

        const payLoad = {
          "clientId": clientId,
          "clientName": clientName,
          "gameId": gameId
        }
        
        socket.emit("join", payLoad);
        
        // console.log(clientId); //test
      });

      btnGameMode.addEventListener("click", e => {
        const payLoad = {
          "gameId": gameId,
          "gameMode": ""
        }

        if(document.getElementById("btnGameModeTxt").innerText.includes("NORMAL")) {
          payLoad.gameMode = "HOLD_EM";
          document.getElementById("btnGameModeTxt").innerText = "Game mode: HOLD_EM";
          Array.from(document.getElementsByClassName("gameMode")).forEach(e => {
            e.innerHTML = "<strong>Game mode: </strong>HOLD_EM";
          });
        }
        else if(document.getElementById("btnGameModeTxt").innerText.includes("HOLD_EM")) { 
          payLoad.gameMode = "NORMAL";
          document.getElementById("btnGameModeTxt").innerText = "Game mode: NORMAL";
          Array.from(document.getElementsByClassName("gameMode")).forEach(e => {
            e.innerHTML = "<strong>Game mode: </strong>NORMAL";
          });
        }
    
        socket.emit("changeGameMode", payLoad);
      });

      btnInit.addEventListener("click", e => {

        const payLoad = {
            "clientId": clientId,
            "gameId": gameId
        }
        socket.emit("init", payLoad);
      });

      btnChangeName.addEventListener("click", e => {
        
        if(document.getElementById("btnChangeNameTxt").innerText === "Change Nickname") {
          document.getElementById("btnChangeNameTxt").innerText = "OK";
          document.getElementById("menuEnterNickname").style.display = "block";
        }
        else if(document.getElementById("btnChangeNameTxt").innerText === "OK") {
          document.getElementById("btnChangeNameTxt").innerText = "Change Nickname";
          document.getElementById("menuEnterNickname").style.display = "none";
          const payLoad = {
            "gameId": gameId,
            "clientId": clientId,
            "clientName": txtName.value
          }
          socket.emit("changeName", payLoad);
        }
      });

      btnTakeTurn.addEventListener("click", e => {
  
        const payLoad = {
            "clientId": clientId,
            "gameId": gameId,
            "nextHandStr": txtNextHand.value
        }

        socket.emit("takeTurn", payLoad);
      });

      btnChallenge.addEventListener("click", e => {

        const payLoad = {
            "gameId": gameId
        }
        socket.emit("challenge", payLoad);
      });

      var handlerOk = function(e) {
        const payLoad = {
            "clientId": clientId,
            "gameId": gameId
        }
        socket.emit("ok", payLoad);
      }

      var handlerHome = function(e) {
        const payLoad = {
            "client": client,
            "clientId": clientId,
            "gameId": gameId
        }
        socket.emit("home", payLoad);
      }

      btnGoBack.forEach(b => {
        b.addEventListener("click", e => {
          window.location.href = "/liars-poker/";
        });
      });

      //join
      socket.on("join", (response) => {
        if(response.active) {
          initialScreen.style.display = "none";
          gameMenu.style.display = "none";
          cannotJoinScreen.style.display = "block";
        }
        else if(!response.success) {
          initialScreen.style.display = "none";
          gameMenu.style.display = "none";
          cannotJoinScreen2.style.display = "block";
        }
        else {
          // document.getElementById("initErrorMsg").style.display = "none";
          Array.from(document.getElementsByClassName("gameId")).forEach(e => {
            e.innerHTML = gameId;
          });
          document.title = gameId + " - Liar's Poker - netcardgames.org"

          var str = '<ol>'
          response.clientsBasicInfo.forEach (c => {
            str += '<li>'+ c.clientName + '</li>';
          });
          str += '</ol>';
          
          Array.from(document.getElementsByClassName("startNumCards")).forEach(e => {
            e.innerHTML = "<strong>Starting # of cards: </strong>" + response.START_NUM_CARDS;
          });
          Array.from(document.getElementsByClassName("maxNumCards")).forEach(e => {
            e.innerHTML = "<strong>Lose at this # of cards: </strong>" + response.MAX_NUM_CARDS;
          });
          Array.from(document.getElementsByClassName("playerNames")).forEach(e => {
            e.innerHTML = str;
          });
          
          if(response.hostId === clientId) {
            document.getElementById("gameSettingsScreen").style.display = "block";
          }
        }
      });

      socket.on("failStart", () => {
        document.getElementById("initErrorMsg").style.display = "block";
      });

      socket.on("changeName", (response) => {
        
        clientName = response.newClientName;
        localStorage.setItem("clientName", clientName);

        var str = '<ol>'
        response.clientsBasicInfo.forEach (c => {
          str += '<li>'+ c.clientName + '</li>';
        });
        str += '</ol>';
        Array.from(document.getElementsByClassName("playerNames")).forEach(e => {
          e.innerHTML = str;
        });

        // console.log("Client name Set successfully " + clientName);
      });

      socket.on("update", (response) => {
        
        client = response.targetPlayer;
                
        initialScreen.style.display = "none";
        takeTurnScreen.style.display = "none";
        resultScreen.style.display = "none";
        gameScreen.style.display = "block";
        if(client.alive) {
          gameScreenAlivePlayers.style.display = "block";
          if(response.isCurrentPlayer) {
            gamePlayScreen.style.display = "block";
            gameWaitScreen.style.display = "none";
          }
          else {
            gamePlayScreen.style.display = "none";
            gameWaitScreen.style.display = "block";
          }
        }
        else {
          gameScreenAlivePlayers.style.display = "none";
          gamePlayScreen.style.display = "none";
          gameWaitScreen.style.display = "block";
        }
        // TODO: display in HTML
        var str = '<ol>'
        response.alivePlayersBasicInfo.forEach (p => {
          var cardEmoji = "";
          for(var i = 0; i < p.numCards; i++) {
            cardEmoji += "ðŸƒ";
          }
          str += '<li>'+ p.clientName + ' (' + cardEmoji + ')</li>';
        });
        str += '</ol>';
        document.getElementById("playersNumCards").innerHTML = str;
                
        while(document.getElementById("imgSharedCards").firstChild) {
          document.getElementById("imgSharedCards").removeChild(document.getElementById("imgSharedCards").firstChild);
        }
        if(response.gameMode === "HOLD_EM") {
          var sharedCardsFrag = document.createDocumentFragment();
          response.sharedCardsURL.forEach(t => {
            var img = document.createElement('img');
            img.src = t;
            img.width = "128";
            img.height = "186";
            sharedCardsFrag.appendChild(img);
          });
          document.getElementById("imgSharedCards").appendChild(sharedCardsFrag);
        }
        else {
          document.getElementById("middleCards").style.display = "none";
        }
                
        while(document.getElementById("imgCurrentHand").firstChild) {
          document.getElementById("imgCurrentHand").removeChild(document.getElementById("imgCurrentHand").firstChild);
        }
        var currentHandFrag = document.createDocumentFragment();
        response.currentHandURL.forEach(t => {
          var img = document.createElement('img');
          img.src = t;
          img.width = "128";
          img.height = "186";
          currentHandFrag.appendChild(img);
        });
        document.getElementById("imgCurrentHand").appendChild(currentHandFrag);

        while(document.getElementById("imgCurrentUserCards").firstChild) {
          document.getElementById("imgCurrentUserCards").removeChild(document.getElementById("imgCurrentUserCards").firstChild);
        }
        var currentUserCardsFrag = document.createDocumentFragment();
        client.cardsAsURL.forEach(t => {
          var img = document.createElement('img');
          img.src = t;
          img.width = "128";
          img.height = "186";
          currentUserCardsFrag.appendChild(img);
        });
        document.getElementById("imgCurrentUserCards").appendChild(currentUserCardsFrag);

        document.getElementById("txtNotYourTurn").innerHTML = "<strong>" + response.currentPlayerName + "</strong> is moving currently...";
        document.getElementById("txtYourTurn").innerHTML = "<strong>" + response.currentPlayerName + "</strong>, it is currently your turn.";

        clientName = response.newClientName;

        var str = '<ol>'
        response.alivePlayersBasicInfo.forEach (c => {
          if(c.clientName === response.currentPlayerName) {
            str += '<li> <b> <u>' + c.clientName + '</u> </b> </li>';
          }
          else {
            str += '<li>' + c.clientName + '</li>';
          }
        });
        str += '</ol>';
        Array.from(document.getElementsByClassName("playerNames")).forEach(e => {
          e.innerHTML = str;
        });
      });

      socket.on("takeTurn", (response) => {
        
        if(response.result === "ERROR: weaker_hand") {
          document.getElementById("txtTakeTurnMsg").innerHTML = 
          "Failed to take a turn. Your request for a hand \"" + response.requestedHandStr + "\" is not better than the current hand.";
        }
        else if(response.result === "ERROR: invalid_hand") {
          document.getElementById("txtTakeTurnMsg").innerHTML = 
          "Your request for a hand is invalid. An example of a valid hand request is: \"Kd 5s Tc Ah Qc\".";
        }
        else if(response.result === "success") {
          gameScreen.style.display = "none";
          gameScreenAlivePlayers.style.display = "none";
          gamePlayScreen.style.display = "none";
          gameWaitScreen.style.display = "none";
          takeTurnScreen.style.display = "block";
          btnOk2.addEventListener("click", handlerOk);
          document.getElementById("txtCdRmv").style.display = "block";
                    
          while(document.getElementById("imgRemovedCards").firstChild) {
            document.getElementById("imgRemovedCards").removeChild(document.getElementById("imgRemovedCards").firstChild);
          }
          var temp = false;
          var removedCardsFrag = document.createDocumentFragment();
          response.removedCardsURL.forEach(t => {
            temp = true;
            var img = document.createElement('img');
            img.src = t;
            img.width = "128";
            img.height = "186";
            removedCardsFrag.appendChild(img);
          });
          document.getElementById("imgRemovedCards").appendChild(removedCardsFrag);
          if(!temp) {
            document.getElementById("txtCdRmv").style.display = "none";
          }

          while(document.getElementById("imgAddedCards").firstChild) {
            document.getElementById("imgAddedCards").removeChild(document.getElementById("imgAddedCards").firstChild);
          }
          var addedCardsFrag = document.createDocumentFragment();
          response.addedCardsURL.forEach(t => {
            var img = document.createElement('img');
            img.src = t;
            img.width = "128";
            img.height = "186";
            addedCardsFrag.appendChild(img);
          });
          document.getElementById("imgAddedCards").appendChild(addedCardsFrag);

          while(document.getElementById("imgCurrentHand2").firstChild) {
            document.getElementById("imgCurrentHand2").removeChild(document.getElementById("imgCurrentHand2").firstChild);
          }
          var currentHandFrag = document.createDocumentFragment();
          response.currentHandURL.forEach(t => {
            var img = document.createElement('img');
            img.src = t;
            img.width = "128";
            img.height = "186";
            currentHandFrag.appendChild(img);
          });
          document.getElementById("imgCurrentHand2").appendChild(currentHandFrag);
        }
        if(!client.alive) {
          document.getElementById("showBtnOk2").style.display = "none";
        }
      });

      socket.on("challenge", (response) => {
        client = response.targetPlayer;

        gameScreen.style.display = "none";
        gameScreenAlivePlayers.style.display = "none";
        gamePlayScreen.style.display = "none";
        gameWaitScreen.style.display = "none";
        resultScreen.style.display = "block";
                
        while(document.getElementById("imgCardsInPlay").firstChild) {
          document.getElementById("imgCardsInPlay").removeChild(document.getElementById("imgCardsInPlay").firstChild);
        }
        var cardsInPlayFrag = document.createDocumentFragment();
        response.cardsInPlayURL.forEach(t => {
          var img = document.createElement('img');
          img.src = t;
          img.width = "128";
          img.height = "186";
          cardsInPlayFrag.appendChild(img);
        });
        document.getElementById("imgCardsInPlay").appendChild(cardsInPlayFrag);
                
        while(document.getElementById("imgCurrentHand3").firstChild) {
          document.getElementById("imgCurrentHand3").removeChild(
          document.getElementById("imgCurrentHand3").firstChild);
        }
        var currentHandFrag = document.createDocumentFragment();
        response.currentHandURL.forEach(t => {
          var img = document.createElement('img');
          img.src = t;
          img.width = "128";
          img.height = "186";
          currentHandFrag.appendChild(img);
        });
        document.getElementById("imgCurrentHand3").appendChild(currentHandFrag);
                    
        if(response.gameContains) {
          document.getElementById("txtTurnResult").innerHTML = "The hand listed above could be found in play.";
          document.getElementById("txtTurnResult2").innerHTML = "The current player <strong>" 
            + response.currentPlayerStr + "</strong> lost this round and has been given an extra card.";
        }
        else {
          document.getElementById("txtTurnResult").innerHTML = "The hand listed above could not be found in play.";
          document.getElementById("txtTurnResult2").innerHTML = "The previous player <strong>" 
          + response.prevPlayerStr + "</strong> lost this round and has been given an extra card.";
        }
        if(response.playerEliminated) {
          document.getElementById("txtTurnResult3").innerHTML ="<strong>" + response.eliminatedPlayerStr
            + "</strong> has too many cards and has been eliminated.";
        }
        if(response.winnerDetermined) {
          document.getElementById("txtTurnResult4").innerHTML = "<strong>" + response.winnerPlayerStr + 
            "</strong> has won the game!";
            document.getElementById("showBtnOk").style.display = "block";
          btnOk.addEventListener("click", handlerHome);
        }
        else {
          btnOk.addEventListener("click", handlerOk);
          if(!client.alive) {
            document.getElementById("showBtnOk").style.display = "none";
          }
        }
      });

      socket.on("ok", (response) => {
        
        if(response.num_ok_needed !== 0) {
          btnOk.removeEventListener("click", handlerOk);
          btnOk2.removeEventListener("click", handlerOk);
          //TODO: add more
        }
      });

      socket.on("home", () => {
        window.location.href = "/liars-poker/";
        /*
        slidingPanel.style.display = "block";
        initialScreen.style.display = "block";
        gameScreen.style.display = "none";
        gameScreenAlivePlayers.style.display = "none";
        gamePlayScreen.style.display = "none";
        gameWaitScreen.style.display = "none";
        resultScreen.style.display = "none";
        */
      });

    </script>
  </body>
</html>